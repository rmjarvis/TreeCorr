

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>GGGCorrelation: Shear-shear-shear correlations &mdash; TreeCorr 5.1.2 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=2c218288"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
      <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="NNKCorrelation: Count-count-scalar correlations" href="nnk.html" />
    <link rel="prev" title="KKKCorrelation: Scalar-scalar-scalar correlations" href="kkk.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            TreeCorr
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="guide.html">Getting Started Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="catalog.html">Input Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="correlation2.html">Two-point Correlation Functions</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="correlation3.html">Three-point Correlation Functions</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="nnn.html">NNNCorrelation: Count-count-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kkk.html">KKKCorrelation: Scalar-scalar-scalar correlations</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">GGGCorrelation: Shear-shear-shear correlations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#treecorr.GGGCorrelation"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.__init__"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.__init__()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.calculateMap3"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.calculateMap3()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.finalize"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.finalize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.getStat"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.getStat()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.getWeight"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.getWeight()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.write"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.write()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#treecorr.GGGCorrelation.writeMap3"><code class="docutils literal notranslate"><span class="pre">GGGCorrelation.writeMap3()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="nnk.html">NNKCorrelation: Count-count-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nnk.html#nkncorrelation-count-scalar-count-correlations">NKNCorrelation: Count-scalar-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nnk.html#knncorrelation-scalar-count-count-correlations">KNNCorrelation: Scalar-count-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nng.html">NNGCorrelation: Count-count-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nng.html#ngncorrelation-count-shear-count-correlations">NGNCorrelation: Count-shear-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nng.html#gnncorrelation-shear-count-count-correlations">GNNCorrelation: Shear-count-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nkk.html">NKKCorrelation: Count-scalar-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nkk.html#knkcorrelation-scalar-count-scalar-correlations">KNKCorrelation: Scalar-count-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="nkk.html#kkncorrelation-scalar-scalar-count-correlations">KKNCorrelation: Scalar-scalar-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngg.html">NGGCorrelation: Count-shear-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngg.html#gngcorrelation-shear-count-shear-correlations">GNGCorrelation: Shear-count-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="ngg.html#ggncorrelation-shear-shear-count-correlations">GGNCorrelation: Shear-shear-count correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kkg.html">KKGCorrelation: Scalar-scalar-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kkg.html#kgkcorrelation-scalar-shear-scalar-correlations">KGKCorrelation: Scalar-shear-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kkg.html#gkkcorrelation-shear-scalar-scalar-correlations">GKKCorrelation: Shear-scalar-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgg.html">KGGCorrelation: Scalar-shear-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgg.html#gkgcorrelation-shear-scalar-shear-correlations">GKGCorrelation: Shear-scalar-shear correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="kgg.html#ggkcorrelation-shear-shear-scalar-correlations">GGKCorrelation: Shear-shear-scalar correlations</a></li>
<li class="toctree-l2"><a class="reference internal" href="correlation3.html#treecorr.Corr3"><code class="docutils literal notranslate"><span class="pre">Corr3</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metric.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="binning.html">Binning</a></li>
<li class="toctree-l1"><a class="reference internal" href="binning3pt.html">Binning for three-point correlations</a></li>
<li class="toctree-l1"><a class="reference internal" href="shear.html">Shear Conventions</a></li>
<li class="toctree-l1"><a class="reference internal" href="patches.html">Patches</a></li>
<li class="toctree-l1"><a class="reference internal" href="cov.html">Covariance Estimates</a></li>
<li class="toctree-l1"><a class="reference internal" href="field.html">Fields</a></li>
<li class="toctree-l1"><a class="reference internal" href="scripts.html">Using configuration files</a></li>
<li class="toctree-l1"><a class="reference internal" href="changes.html">Changes from version 5.0 to 5.1</a></li>
<li class="toctree-l1"><a class="reference internal" href="history.html">Previous History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TreeCorr</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="correlation3.html">Three-point Correlation Functions</a></li>
      <li class="breadcrumb-item active">GGGCorrelation: Shear-shear-shear correlations</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/ggg.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="gggcorrelation-shear-shear-shear-correlations">
<h1>GGGCorrelation: Shear-shear-shear correlations<a class="headerlink" href="#gggcorrelation-shear-shear-shear-correlations" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation">
<em class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">treecorr.</span></span><span class="sig-name descname"><span class="pre">GGGCorrelation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation" title="Link to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="correlation3.html#treecorr.Corr3" title="treecorr.corr3base.Corr3"><code class="xref py py-class docutils literal notranslate"><span class="pre">Corr3</span></code></a></p>
<p>This class handles the calculation and storage of a 3-point shear-shear-shear correlation
function.</p>
<p>We use the “natural components” of the shear 3-point function described by Schneider &amp;
Lombardi (2003) [Astron.Astrophys. 397 (2003) 809-818].  In this paradigm, the shears
are projected relative to some point defined by the geometry of the triangle.  They
give several reasonable choices for this point.  We choose the triangle’s centroid as the
“most natural” point, as many simple shear fields have purely real <span class="math notranslate nohighlight">\(\Gamma_0\)</span> using
this definition.  It is also a fairly simple point to calculate in the code compared to
some of the other options they offer, so projections relative to it are fairly efficient.</p>
<p>There are 4 complex-valued 3-point shear correlation functions defined for triples of shear
values projected relative to the line joining the location of the shear to the centroid of
the triangle:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\Gamma_0 &amp;= \langle \gamma(\mathbf{x1}) \gamma(\mathbf{x2}) \gamma(\mathbf{x3}) \rangle \\
\Gamma_1 &amp;= \langle \gamma(\mathbf{x1})^* \gamma(\mathbf{x2}) \gamma(\mathbf{x3}) \rangle \\
\Gamma_2 &amp;= \langle \gamma(\mathbf{x1}) \gamma(\mathbf{x2})^* \gamma(\mathbf{x3}) \rangle \\
\Gamma_3 &amp;= \langle \gamma(\mathbf{x1}) \gamma(\mathbf{x2}) \gamma(\mathbf{x3})^* \rangle \\\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\mathbf{x1}, \mathbf{x2}, \mathbf{x3}\)</span> are the corners of the triangle opposite
sides d1, d2, d3 respectively, where d1 &gt; d2 &gt; d3, and <span class="math notranslate nohighlight">\({}^*\)</span> indicates complex
conjugation.</p>
<p>See the docstring of <a class="reference internal" href="correlation3.html#treecorr.Corr3" title="treecorr.Corr3"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Corr3</span></code></a> for a description of how the triangles are binned along
with the attributes related to the different binning options.</p>
<p>In addition to the attributes common to all <a class="reference internal" href="correlation3.html#treecorr.Corr3" title="treecorr.Corr3"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Corr3</span></code></a> subclasses, objects of this class
hold the following attributes:</p>
<dl class="field-list simple">
<dt class="field-odd">Attributes<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gam0</strong> – The 0th “natural” correlation function, <span class="math notranslate nohighlight">\(\Gamma_0\)</span>.</p></li>
<li><p><strong>gam1</strong> – The 1st “natural” correlation function, <span class="math notranslate nohighlight">\(\Gamma_1\)</span>.</p></li>
<li><p><strong>gam2</strong> – The 2nd “natural” correlation function, <span class="math notranslate nohighlight">\(\Gamma_2\)</span>.</p></li>
<li><p><strong>gam3</strong> – The 3rd “natural” correlation function, <span class="math notranslate nohighlight">\(\Gamma_3\)</span>.</p></li>
<li><p><strong>vargam0</strong> – The variance estimate of <span class="math notranslate nohighlight">\(\Gamma_0\)</span>, computed according to <code class="docutils literal notranslate"><span class="pre">var_method</span></code>
(default: <code class="docutils literal notranslate"><span class="pre">'shot'</span></code>).</p></li>
<li><p><strong>vargam1</strong> – The variance estimate of <span class="math notranslate nohighlight">\(\Gamma_1\)</span>.</p></li>
<li><p><strong>vargam2</strong> – The variance estimate of <span class="math notranslate nohighlight">\(\Gamma_2\)</span>.</p></li>
<li><p><strong>vargam3</strong> – The variance estimate of <span class="math notranslate nohighlight">\(\Gamma_3\)</span>.</p></li>
</ul>
</dd>
</dl>
<p>The typical usage pattern is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ggg</span> <span class="o">=</span> <span class="n">treecorr</span><span class="o">.</span><span class="n">GGGCorrelation</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ggg</span><span class="o">.</span><span class="n">process</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span>                <span class="c1"># Compute the auto-correlation.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># ggg.process(cat1, cat2, cat3) # ... or the cross-correlation.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ggg</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>            <span class="c1"># Write out to a file.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gam0</span> <span class="o">=</span> <span class="n">ggg</span><span class="o">.</span><span class="n">gam0</span><span class="p">,</span> <span class="n">etc</span><span class="o">.</span>           <span class="c1"># Access gamma values directly.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gam0r</span> <span class="o">=</span> <span class="n">ggg</span><span class="o">.</span><span class="n">gam0r</span>               <span class="c1"># Or access real and imaginary parts separately.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gam0i</span> <span class="o">=</span> <span class="n">ggg</span><span class="o">.</span><span class="n">gam0i</span>
</pre></div>
</div>
<p>See also: <a class="reference internal" href="kgg.html#treecorr.KGGCorrelation" title="treecorr.KGGCorrelation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">KGGCorrelation</span></code></a>, <a class="reference internal" href="ngg.html#treecorr.NGGCorrelation" title="treecorr.NGGCorrelation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">NGGCorrelation</span></code></a>, <a class="reference internal" href="gg.html#treecorr.GGCorrelation" title="treecorr.GGCorrelation"><code class="xref any py py-class docutils literal notranslate"><span class="pre">GGCorrelation</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a>) – A configuration dict that can be used to pass in kwargs if desired.
This dict is allowed to have additional entries besides those listed
in <a class="reference internal" href="correlation3.html#treecorr.Corr3" title="treecorr.Corr3"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Corr3</span></code></a>, which are ignored here. (default: None)</p></li>
<li><p><strong>logger</strong> (<a class="reference external" href="https://docs.python.org/3/library/logging.html#logging.Logger" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">logging.Logger</span></code></a>) – If desired, a <code class="docutils literal notranslate"><span class="pre">Logger</span></code> object for logging. (default: None, in which case
one will be built according to the config dict’s verbose level.)</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>**kwargs</strong> – See the documentation for <a class="reference internal" href="correlation3.html#treecorr.Corr3" title="treecorr.Corr3"><code class="xref any py py-class docutils literal notranslate"><span class="pre">Corr3</span></code></a> for the list of allowed keyword
arguments, which may be passed either directly or in the config dict.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">logger</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.__init__"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.__init__" title="Link to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.calculateMap3">
<span class="sig-name descname"><span class="pre">calculateMap3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k2</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.calculateMap3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.calculateMap3" title="Link to this definition"></a></dt>
<dd><p>Calculate the skewness of the aperture mass from the correlation function.</p>
<p>The equations for this come from Jarvis, Bernstein &amp; Jain (2004, MNRAS, 352).
See their section 3, especially equations 51 and 52 for the <span class="math notranslate nohighlight">\(T_i\)</span> functions,
equations 60 and 61 for the calculation of <span class="math notranslate nohighlight">\(\langle \cal M^3 \rangle\)</span> and
<span class="math notranslate nohighlight">\(\langle \cal M^2 M^* \rangle\)</span>, and equations 55-58 for how to convert
these to the return values.</p>
<p>If k2 or k3 != 1, then this routine calculates the generalization of the skewness
proposed by Schneider, Kilbinger &amp; Lombardi (2005, A&amp;A, 431):
<span class="math notranslate nohighlight">\(\langle M_{ap}^3(R, k_2 R, k_3 R)\rangle\)</span> and related values.</p>
<p>If k2 = k3 = 1 (the default), then there are only 4 combinations of Map and Mx
that are relevant:</p>
<ul class="simple">
<li><p>map3 = <span class="math notranslate nohighlight">\(\langle M_{ap}^3(R)\rangle\)</span></p></li>
<li><p>map2mx = <span class="math notranslate nohighlight">\(\langle M_{ap}^2(R) M_\times(R)\rangle\)</span>,</p></li>
<li><p>mapmx2 = <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_\times(R)\rangle\)</span></p></li>
<li><p>mx3 = <span class="math notranslate nohighlight">\(\langle M_{\rm \times}^3(R)\rangle\)</span></p></li>
</ul>
<p>However, if k2 or k3 != 1, then there are 8 combinations:</p>
<ul class="simple">
<li><p>map3 = <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_{ap}(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mapmapmx = <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_{ap}(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mapmxmap = <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_\times(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmapmap = <span class="math notranslate nohighlight">\(\langle M_\times(R) M_{ap}(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmxmap = <span class="math notranslate nohighlight">\(\langle M_\times(R) M_\times(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmapmx = <span class="math notranslate nohighlight">\(\langle M_\times(R) M_{ap}(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mapmxmx = <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_\times(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mx3 = <span class="math notranslate nohighlight">\(\langle M_\times(R) M_\times(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
</ul>
<p>To accommodate this full generality, we always return all 8 values, along with the
estimated variance (which is equal for each), even when k2 = k3 = 1.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The formulae for the <code class="docutils literal notranslate"><span class="pre">m2_uform</span></code> = ‘Schneider’ definition of the aperture mass,
described in the documentation of <a class="reference internal" href="gg.html#treecorr.GGCorrelation.calculateMapSq" title="treecorr.GGCorrelation.calculateMapSq"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">calculateMapSq</span></code></a>, are not known, so that is not an
option here.  The calculations here use the definition that corresponds to
<code class="docutils literal notranslate"><span class="pre">m2_uform</span></code> = ‘Crittenden’.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The R values at which to calculate the aperture mass statistics.
(default: None, which means to use self.rnom1d)</p></li>
<li><p><strong>k2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – If given, the ratio R2/R1 in the SKL formulae. (default: 1)</p></li>
<li><p><strong>k3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – If given, the ratio R3/R1 in the SKL formulae. (default: 1)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>map3 = array of <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_{ap}(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mapmapmx = array of <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_{ap}(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mapmxmap = array of <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_\times(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmapmap = array of <span class="math notranslate nohighlight">\(\langle M_\times(R) M_{ap}(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmxmap = array of <span class="math notranslate nohighlight">\(\langle M_\times(R) M_\times(k_2 R) M_{ap}(k_3 R)\rangle\)</span></p></li>
<li><p>mxmapmx = array of <span class="math notranslate nohighlight">\(\langle M_\times(R) M_{ap}(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mapmxmx = array of <span class="math notranslate nohighlight">\(\langle M_{ap}(R) M_\times(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>mx3 = array of <span class="math notranslate nohighlight">\(\langle M_\times(R) M_\times(k_2 R) M_\times(k_3 R)\rangle\)</span></p></li>
<li><p>varmap3 = array of variance estimates of the above values</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple containing</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.finalize">
<span class="sig-name descname"><span class="pre">finalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">varg1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varg2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">varg3</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.finalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.finalize" title="Link to this definition"></a></dt>
<dd><p>Finalize the calculation of the correlation function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>varg1</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The variance per component of the first shear field.</p></li>
<li><p><strong>varg2</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The variance per component of the second shear field.</p></li>
<li><p><strong>varg3</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a>) – The variance per component of the third shear field.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.getStat">
<span class="sig-name descname"><span class="pre">getStat</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.getStat"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.getStat" title="Link to this definition"></a></dt>
<dd><p>The standard statistic for the current correlation object as a 1-d array.</p>
<p>In this case, the concatenation of gam0.ravel(), gam1.ravel(), gam2.ravel(), gam3.ravel().</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a complex array, unlike most other statistics.
The computed covariance matrix will be complex, although since it is Hermitian the
diagonal is real, so the resulting vargam0, etc. will all be real arrays.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.getWeight">
<span class="sig-name descname"><span class="pre">getWeight</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.getWeight"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.getWeight" title="Link to this definition"></a></dt>
<dd><p>The weight array for the current correlation object as a 1-d array.</p>
<p>In this case, 4 copies of self.weight.ravel().</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_patch_results</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">write_cov</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.write" title="Link to this definition"></a></dt>
<dd><p>Write the correlation function to the file, file_name.</p>
<p>For bin_type = LogRUV, the output file will include the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>r_nom</p></td>
<td><p>The nominal center of the bin in r = d2 where d1 &gt; d2 &gt; d3</p></td>
</tr>
<tr class="row-odd"><td><p>u_nom</p></td>
<td><p>The nominal center of the bin in u = d3/d2</p></td>
</tr>
<tr class="row-even"><td><p>v_nom</p></td>
<td><p>The nominal center of the bin in v = +-(d1-d2)/d3</p></td>
</tr>
<tr class="row-odd"><td><p>meanu</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle u\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
<tr class="row-even"><td><p>meanv</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle v\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
</tbody>
</table>
<p>For bin_type = LogSAS, the output file will include the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>d2_nom</p></td>
<td><p>The nominal center of the bin in d2</p></td>
</tr>
<tr class="row-odd"><td><p>d3_nom</p></td>
<td><p>The nominal center of the bin in d3</p></td>
</tr>
<tr class="row-even"><td><p>phi_nom</p></td>
<td><p>The nominal center of the bin in phi, the opening angle between
d2 and d3 in the counter-clockwise direction</p></td>
</tr>
<tr class="row-odd"><td><p>meanphi</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle phi\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
</tbody>
</table>
<p>For bin_type = LogMultipole, the output file will include the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>d2_nom</p></td>
<td><p>The nominal center of the bin in d2</p></td>
</tr>
<tr class="row-odd"><td><p>d3_nom</p></td>
<td><p>The nominal center of the bin in d3</p></td>
</tr>
<tr class="row-even"><td><p>n</p></td>
<td><p>The multipole index n</p></td>
</tr>
</tbody>
</table>
<p>In addition, all bin types include the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>meand1</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle d1\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
<tr class="row-odd"><td><p>meanlogd1</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle \log(d1)\rangle\)</span> of triangles that
fell into each bin</p></td>
</tr>
<tr class="row-even"><td><p>meand2</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle d2\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
<tr class="row-odd"><td><p>meanlogd2</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle \log(d2)\rangle\)</span> of triangles that
fell into each bin</p></td>
</tr>
<tr class="row-even"><td><p>meand3</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle d3\rangle\)</span> of triangles that fell
into each bin</p></td>
</tr>
<tr class="row-odd"><td><p>meanlogd3</p></td>
<td><p>The mean value <span class="math notranslate nohighlight">\(\langle \log(d3)\rangle\)</span> of triangles that
fell into each bin</p></td>
</tr>
<tr class="row-even"><td><p>gam0r</p></td>
<td><p>The real part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>gam0i</p></td>
<td><p>The imaginary part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_0\)</span></p></td>
</tr>
<tr class="row-even"><td><p>gam1r</p></td>
<td><p>The real part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_1\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>gam1i</p></td>
<td><p>The imaginary part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>gam2r</p></td>
<td><p>The real part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>gam2i</p></td>
<td><p>The imaginary part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_2\)</span></p></td>
</tr>
<tr class="row-even"><td><p>gam3r</p></td>
<td><p>The real part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_3\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>gam3i</p></td>
<td><p>The imaginary part of the estimator of <span class="math notranslate nohighlight">\(\Gamma_3\)</span></p></td>
</tr>
<tr class="row-even"><td><p>sigma_gam0</p></td>
<td><p>The sqrt of the variance estimate of <span class="math notranslate nohighlight">\(\Gamma_0\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>sigma_gam1</p></td>
<td><p>The sqrt of the variance estimate of <span class="math notranslate nohighlight">\(\Gamma_1\)</span></p></td>
</tr>
<tr class="row-even"><td><p>sigma_gam2</p></td>
<td><p>The sqrt of the variance estimate of <span class="math notranslate nohighlight">\(\Gamma_2\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>sigma_gam3</p></td>
<td><p>The sqrt of the variance estimate of <span class="math notranslate nohighlight">\(\Gamma_3\)</span></p></td>
</tr>
<tr class="row-even"><td><p>weight</p></td>
<td><p>The total weight of triangles contributing to each bin.
(For LogMultipole, this is split into real and imaginary parts,
weightr and weighti.)</p></td>
</tr>
<tr class="row-odd"><td><p>ntri</p></td>
<td><p>The number of triangles contributing to each bin</p></td>
</tr>
</tbody>
</table>
<p>If <code class="docutils literal notranslate"><span class="pre">sep_units</span></code> was given at construction, then the distances will all be in these units.
Otherwise, they will be in either the same units as x,y,z (for flat or 3d coordinates) or
radians (for spherical coordinates).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the file to write to.</p></li>
<li><p><strong>file_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The type of file to write (‘ASCII’ or ‘FITS’).  (default: determine
the type automatically from the extension of file_name.)</p></li>
<li><p><strong>precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – For ASCII output files, the desired precision. (default: 4;
this value can also be given in the constructor in the config dict.)</p></li>
<li><p><strong>write_patch_results</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to write the patch-based results as well.
(default: False)</p></li>
<li><p><strong>write_cov</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>) – Whether to write the covariance matrix as well. (default: False)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="treecorr.GGGCorrelation.writeMap3">
<span class="sig-name descname"><span class="pre">writeMap3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file_name</span></span></em>, <em class="sig-param"><span class="keyword-only-separator o"><abbr title="Keyword-only parameters separator (PEP 3102)"><span class="pre">*</span></abbr></span></em>, <em class="sig-param"><span class="n"><span class="pre">R</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/treecorr/gggcorrelation.html#GGGCorrelation.writeMap3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#treecorr.GGGCorrelation.writeMap3" title="Link to this definition"></a></dt>
<dd><p>Write the aperture mass skewness based on the correlation function to the
file, file_name.</p>
<p>The output file will include the following columns:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Column</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>R</p></td>
<td><p>The aperture radius</p></td>
</tr>
<tr class="row-odd"><td><p>Map3</p></td>
<td><p>An estimate of <span class="math notranslate nohighlight">\(\langle M_{ap}^3\rangle(R)\)</span>
(cf. <a class="reference internal" href="#treecorr.GGGCorrelation.calculateMap3" title="treecorr.GGGCorrelation.calculateMap3"><code class="xref any py py-meth docutils literal notranslate"><span class="pre">calculateMap3</span></code></a>)</p></td>
</tr>
<tr class="row-even"><td><p>Map2Mx</p></td>
<td><p>An estimate of <span class="math notranslate nohighlight">\(\langle M_{ap}^2 M_\times\rangle(R)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>MapMx2</p></td>
<td><p>An estimate of <span class="math notranslate nohighlight">\(\langle M_{ap} M_\times^2\rangle(R)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Mx3</p></td>
<td><p>An estimate of <span class="math notranslate nohighlight">\(\langle M_\times^3\rangle(R)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>sig_map</p></td>
<td><p>The sqrt of the variance estimate of each of these</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The name of the file to write to.</p></li>
<li><p><strong>R</strong> (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v2.4)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>) – The R values at which to calculate the statistics.
(default: None, which means to use self.rnom)</p></li>
<li><p><strong>file_type</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a>) – The type of file to write (‘ASCII’ or ‘FITS’).  (default: determine
the type automatically from the extension of file_name.)</p></li>
<li><p><strong>precision</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>) – For ASCII output files, the desired precision. (default: 4;
this value can also be given in the constructor in the config dict.)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="kkk.html" class="btn btn-neutral float-left" title="KKKCorrelation: Scalar-scalar-scalar correlations" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="nnk.html" class="btn btn-neutral float-right" title="NNKCorrelation: Count-count-scalar correlations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Mike Jarvis.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>